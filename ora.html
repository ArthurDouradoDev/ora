<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ora - Nova Aba</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="scripts/phosphor.js"></script>
    <link rel="stylesheet" href="styles/base/variables.css">
    <link rel="stylesheet" href="styles/components/glass-panels.css">
    <link rel="stylesheet" href="styles/components/buttons.css">
    <link rel="stylesheet" href="styles/components/inputs.css">
    <link rel="stylesheet" href="styles/components/modals.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="assets/icon.png">
</head>
<body>

    <div class="overlay"></div>

    <header>
        <div class="links-container">
            <a href="https://padrepauloricardo.org/liturgia/" target="_blank" class="glass-panel action-btn" style="text-decoration: none; color: inherit;">
                <i class="ph ph-book-open-text"></i> Liturgia
            </a>
            
            <div class="glass-panel action-btn" id="btn-music"><i class="ph ph-music-notes"></i> Música</div>
        </div>
        <div class="links-container">
            <div class="glass-panel action-btn"><i class="ph ph-sun"></i> 24°C</div>
            <div class="glass-panel action-btn" id="btn-blocker"><i class="ph ph-shield-slash"></i> Bloqueador</div>
        </div>
    </header>

    <!-- Angelus Reminder (6h-8h, 12h-13h, 18h-20h) -->
    <div id="angelus-reminder" class="glass-panel modal-slide" style="display: none;">
        <div class="angelus-content">
            <i class="ph ph-bell-ringing"></i>
            <span>Hora do Angelus</span>
        </div>
        <div class="angelus-actions">
            <button id="open-angelus-btn" class="pray-btn" title="Rezar"><i class="ph ph-hands-praying"></i></button>
            <button id="check-angelus-btn" class="icon-btn-sm check-btn" title="Marcar como feito">
                <i class="ph ph-check"></i>
            </button>
        </div>
    </div>

    <!-- Mercy Reminder (15h-16h) -->
    <div id="mercy-reminder" class="glass-panel modal-slide" style="display: none;">
        <div class="angelus-content">
            <i class="ph ph-drop"></i>
            <span>Hora da Misericórdia</span>
        </div>
        <div class="angelus-actions">
            <button id="open-mercy-btn" class="pray-btn" title="Rezar"><i class="ph ph-hands-praying"></i></button>
            <button id="check-mercy-btn" class="icon-btn-sm check-btn" title="Marcar como feito">
                <i class="ph ph-check"></i>
            </button>
        </div>
    </div>

    <!-- Music Library Modal -->
    <div id="music-library" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <h3>Biblioteca</h3>
            <button id="close-library-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        
        <div class="add-playlist-section">
            <input type="text" id="playlist-input" placeholder="Link YouTube/Spotify...">
            <button id="add-playlist-btn" class="glass-panel-sm"><i class="ph ph-plus"></i></button>
        </div>

        <div id="playlist-grid" class="playlist-grid"></div>
    </div>

    <!-- Mini Player - Fixed Position Left Side -->
    <div id="mini-player" class="glass-panel modal modal-corner-left modal-fade" style="display: none;">
        <div class="player-header">
            <span id="now-playing-text">Tocando...</span>
            <div class="player-actions">
                <button id="minimize-player-btn" class="icon-btn-sm" title="Minimizar">
                    <i class="ph ph-caret-down"></i>
                </button>
                <button id="open-external-btn" class="icon-btn-sm" title="Abrir no app">
                    <i class="ph ph-arrow-square-out"></i>
                </button>
                <button id="close-player-btn" class="icon-btn-sm" title="Fechar">
                    <i class="ph ph-x"></i>
                </button>
            </div>
        </div>
        <div class="iframe-container" id="iframe-container">
            <iframe 
                id="youtube-iframe" 
                width="100%" 
                height="352" 
                src="" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" 
                style="display: none; border-radius: 12px;">
            </iframe>
            
            <iframe id="spotify-iframe" style="border-radius:12px; display: none;" src="" width="100%" height="352" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>
    </div>

    <main>


        <div class="clock" id="clock">00:00</div>
        <div class="greeting"></div>
        <div class="focus-section">
            <input type="text" id="intention-input" placeholder="Qual sua intenção hoje?">
        </div>

        <!-- Quick Links Section -->
        <div id="quick-links-container" class="links-grid">
            <!-- Links will be injected here by links.js -->
        </div>
    </main>

    <footer>
        <div class="footer-left">
            <a href="https://padrepauloricardo.org/biblia/gn?cap=1&edition=matos-soares" target="_blank" class="glass-panel action-btn" style="text-decoration: none; color: inherit;">
                <i class="ph ph-book-bookmark"></i> Bíblia
            </a>
            <div class="glass-panel action-btn" id="btn-focus"><i class="ph ph-timer"></i> Pomodoro</div>
            <div class="glass-panel action-btn" id="btn-exam"><i class="ph ph-heart"></i> Examinar</div>
        </div>
        
        <div class="quote-container">
            <div class="quote-text"></div>
            <div class="quote-author"></div>
        </div>

        <div class="footer-right">
            <div class="glass-panel action-btn" id="btn-rosary"><i class="ph ph-cross"></i> Terço</div>
            <div class="glass-panel action-btn" id="btn-prayers">Orações <i class="ph ph-caret-up"></i></div>
        </div>
    </footer>

    <!-- Focus Timer - Compact Mini Modal -->
    <div id="focus-mini" class="glass-panel modal modal-corner-bottom-left modal-fade" style="display: none;">
        <div class="focus-mini-header">
            <span class="focus-mini-phase">Foco</span>
            <div class="focus-mini-actions">
                <button id="focus-mini-expand" class="icon-btn-sm" title="Tela cheia"><i class="ph ph-arrows-out"></i></button>
                <button id="focus-mini-minimize" class="icon-btn-sm" title="Minimizar"><i class="ph ph-caret-down"></i></button>
                <button id="focus-mini-close" class="icon-btn-sm" title="Fechar"><i class="ph ph-x"></i></button>
            </div>
        </div>
        <div class="focus-mini-body">
            <div class="focus-mini-timer">25:00</div>
            <div class="focus-mini-controls">
                <button id="focus-mini-play" class="icon-btn-sm" title="Iniciar"><i class="ph ph-play"></i></button>
                <button id="focus-mini-skip" class="icon-btn-sm" title="Pular"><i class="ph ph-skip-forward"></i></button>
                <button id="focus-mini-reset" class="icon-btn-sm" title="Resetar"><i class="ph ph-arrow-counter-clockwise"></i></button>
            </div>
        </div>
        <div class="focus-mini-footer">
            <span class="focus-mini-total"><i class="ph ph-fire"></i> Total: 0m</span>
            <div class="focus-mini-dots"></div>
        </div>
    </div>

    <!-- Focus Timer - Fullscreen Overlay -->
    <div id="focus-fullscreen" class="modal-fs" style="display: none;">
        <div class="focus-fs-header">
            <button id="focus-fs-settings-btn" class="icon-btn" title="Configurações"><i class="ph ph-gear"></i></button>
            <button id="focus-fs-collapse" class="icon-btn" title="Modo compacto"><i class="ph ph-arrows-in"></i></button>
        </div>

        <div class="focus-fs-content">
            <div class="focus-fs-phase">Foco</div>
            <div class="focus-fs-ring-container">
                <svg class="focus-ring" viewBox="0 0 200 200">
                    <circle class="focus-ring-bg" cx="100" cy="100" r="90" />
                    <circle class="focus-ring-progress" cx="100" cy="100" r="90" />
                </svg>
                <div class="focus-fs-timer">25:00</div>
            </div>
            <div class="focus-fs-dots"></div>
            <div class="focus-fs-controls">
                <button id="focus-fs-reset" class="control-btn" title="Resetar"><i class="ph ph-arrow-counter-clockwise"></i></button>
                <button id="focus-fs-play" class="control-btn control-btn-play" title="Iniciar"><i class="ph ph-play"></i></button>
                <button id="focus-fs-skip" class="control-btn" title="Pular"><i class="ph ph-skip-forward"></i></button>
            </div>
            <div class="focus-fs-total"><i class="ph ph-fire"></i> Total hoje: 0m</div>
        </div>

        <!-- Settings Panel (hidden by default) -->
        <div id="focus-settings" class="focus-settings-panel" style="display: none;">
            <h4>Configurações</h4>
            <div class="focus-setting-row">
                <label>Foco (min)</label>
                <input type="number" id="setting-focus" min="1" max="120" value="25">
            </div>
            <div class="focus-setting-row">
                <label>Pausa (min)</label>
                <input type="number" id="setting-pause" min="1" max="30" value="5">
            </div>
            <div class="focus-setting-row">
                <label>Pausa Longa (min)</label>
                <input type="number" id="setting-long-pause" min="1" max="60" value="15">
            </div>
        </div>
    </div>

    <!-- Prayer List Modal -->
    <div id="prayer-list" class="glass-panel modal modal-corner-bottom-right modal-fade" style="display: none;">
        <div class="modal-header" style="flex-direction: column; align-items: stretch; gap: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3>Orações</h3>
                <button id="close-prayer-list-btn" class="icon-btn"><i class="ph ph-x"></i></button>
            </div>
            <div class="prayer-search-container">
                <i class="ph ph-magnifying-glass search-icon"></i>
                <input type="text" id="prayer-search-input" placeholder="Buscar oração...">
            </div>
        </div>
        <div id="prayer-grid" class="prayer-grid"></div>
    </div>

    <!-- Prayer Reader Modal -->
    <div id="prayer-reader" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <button id="back-to-list-btn" class="icon-btn" title="Voltar"><i class="ph ph-arrow-left"></i></button>
            <h3 id="prayer-reader-title">Oração</h3>
            <button id="close-prayer-reader-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div class="lang-toggle">
            <button class="lang-btn active" data-lang="pt">Português</button>
            <button class="lang-btn" data-lang="la">Latim</button>
        </div>
        <div id="prayer-text" class="prayer-text"></div>
    </div>

    <!-- Rosary (Terço) Modal -->
    <div id="rosary-modal" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <h3 id="rosary-modal-title">Santo Terço</h3>
            <div class="lang-toggle-rosary" style="display: flex; gap: 8px; margin-right: 16px;">
                <button class="lang-btn active" data-lang="pt">PT</button>
                <button class="lang-btn" data-lang="la">LA</button>
            </div>
            <button id="reset-rosary-btn" class="icon-btn" title="Recomeçar"><i class="ph ph-arrow-counter-clockwise"></i></button>
            <button id="close-rosary-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div class="rosary-chaplet-selector">
            <button class="rosary-chaplet-btn active" data-chaplet="terco"><i class="ph ph-cross"></i> Santo Terço</button>
            <button class="rosary-chaplet-btn" data-chaplet="misericordia"><i class="ph ph-heart"></i> Misericórdia</button>
        </div>
        <div class="rosary-mystery-selector">
            <button class="rosary-mystery-btn active" data-mystery="gozosos">Gozosos</button>
            <button class="rosary-mystery-btn" data-mystery="dolorosos">Dolorosos</button>
            <button class="rosary-mystery-btn" data-mystery="gloriosos">Gloriosos</button>
            <button class="rosary-mystery-btn" data-mystery="luminosos">Luminosos</button>
        </div>
        <div class="rosary-mystery-name"></div>
        <div class="rosary-beads-container"></div>
        <div class="rosary-prayer-display">
            <div class="rosary-prayer-title"></div>
            <div class="rosary-prayer-text"></div>
        </div>
        <div class="rosary-nav">
            <button id="rosary-prev" class="icon-btn"><i class="ph ph-caret-left"></i></button>
            <span class="rosary-counter">1 / 72</span>
            <button id="rosary-next" class="icon-btn"><i class="ph ph-caret-right"></i></button>
        </div>
    </div>

    <!-- Exam Type Selector Modal -->
    <div id="exam-type-modal" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <h3>Examinar</h3>
            <button id="close-exam-type-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div class="exam-suggestion"></div>
        <div id="exam-type-grid" class="exam-type-grid"></div>
        <div class="exam-virtues-link">
            <button id="open-virtues-btn" class="glass-panel-sm exam-virtues-btn"><i class="ph ph-list-checks"></i> Checklist de Virtudes</button>
        </div>
        <div class="exam-streak">
            <i class="ph ph-fire"></i>
            <span id="exam-streak-text">0 exames esta semana</span>
        </div>
    </div>

    <!-- Exam Flow Modal -->
    <div id="exam-flow-modal" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <button id="exam-flow-back-btn" class="icon-btn" title="Voltar"><i class="ph ph-arrow-left"></i></button>
            <h3 id="exam-flow-title">Exame</h3>
            <button id="close-exam-flow-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div class="exam-progress-bar"><div class="exam-progress-fill"></div></div>
        <div class="exam-question-container">
            <div class="exam-question-text"></div>
            <div class="exam-input-area"></div>
        </div>
        <div class="exam-flow-nav">
            <button id="exam-prev-btn" class="icon-btn" title="Anterior"><i class="ph ph-caret-left"></i></button>
            <span class="exam-step-counter">1 / 3</span>
            <button id="exam-next-btn" class="icon-btn" title="Próximo"><i class="ph ph-caret-right"></i></button>
        </div>
    </div>

    <!-- Pomodoro Emotional Check-in -->
    <div id="pomodoro-checkin" class="glass-panel modal modal-center modal-fade" style="display: none;">
        <div class="checkin-header">
            <span class="checkin-title">Como está seu coração?</span>
            <button id="close-checkin-btn" class="icon-btn-sm"><i class="ph ph-x"></i></button>
        </div>
        <div class="checkin-options"></div>
    </div>

    <!-- Micro-Prayer Suggestion -->
    <div id="micro-prayer-modal" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <button id="micro-prayer-back-btn" class="icon-btn" title="Voltar"><i class="ph ph-arrow-left"></i></button>
            <h3>Oração Rápida</h3>
            <button id="close-micro-prayer-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div id="micro-prayer-options" class="micro-prayer-grid"></div>
        <div id="micro-prayer-text" class="prayer-text" style="display: none;"></div>
    </div>

    <!-- Midday Exam Reminder -->
    <div id="midday-reminder" class="glass-panel modal-slide" style="display: none;">
        <div class="angelus-content">
            <i class="ph ph-sun-horizon"></i>
            <span>Hora do Exame Meridiano</span>
        </div>
        <div class="angelus-actions">
            <button id="start-midday-btn" class="pray-btn" title="Iniciar"><i class="ph ph-play"></i></button>
            <button id="check-midday-btn" class="icon-btn-sm check-btn" title="Marcar como feito">
                <i class="ph ph-check"></i>
            </button>
        </div>
    </div>

    <!-- Evening Exam Reminder -->
    <div id="evening-reminder" class="glass-panel modal-slide" style="display: none;">
        <div class="angelus-content">
            <i class="ph ph-moon-stars"></i>
            <span>Hora do Exame Noturno</span>
        </div>
        <div class="angelus-actions">
            <button id="start-evening-btn" class="pray-btn" title="Iniciar"><i class="ph ph-play"></i></button>
            <button id="check-evening-btn" class="icon-btn-sm check-btn" title="Marcar como feito">
                <i class="ph ph-check"></i>
            </button>
        </div>
    </div>

    <!-- Rosary Suggestion (After Pomodoro) -->
    <div id="rosary-reminder" class="glass-panel modal-slide" style="display: none;">
        <div class="angelus-content">
            <i class="ph ph-flower-lotus"></i>
            <span>Rezar uma dezena?</span>
        </div>
        <div class="angelus-actions">
            <button id="start-rosary-btn" class="pray-btn" title="Iniciar"><i class="ph ph-play"></i></button>
            <button id="dismiss-rosary-btn" class="icon-btn-sm check-btn" title="Agora não">
                <i class="ph ph-x"></i>
            </button>
        </div>
    </div>

    <!-- Virtues Checklist Modal -->
    <div id="virtues-modal" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <button id="virtues-back-btn" class="icon-btn" title="Voltar"><i class="ph ph-arrow-left"></i></button>
            <h3>Virtudes do Dia</h3>
            <button id="close-virtues-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div id="virtues-list" class="virtues-list"></div>
        <div class="virtues-summary">
            <span id="virtues-summary-text"></span>
        </div>
        <div class="virtues-edit-section">
            <button id="edit-virtues-btn" class="glass-panel-sm exam-virtues-btn"><i class="ph ph-pencil"></i> Editar Virtudes</button>
        </div>
    </div>

    <!-- Virtues Editor Modal -->
    <div id="virtues-editor" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <button id="virtues-editor-back-btn" class="icon-btn" title="Voltar"><i class="ph ph-arrow-left"></i></button>
            <h3>Editar Virtudes</h3>
            <button id="close-virtues-editor-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div id="virtues-editor-list" class="virtues-editor-list"></div>
        <div class="add-virtue-section">
            <input type="text" id="new-virtue-input" placeholder="Nova virtude...">
            <button id="add-virtue-btn" class="glass-panel-sm"><i class="ph ph-plus"></i></button>
        </div>
    </div>

    <!-- Site Blocker Modal -->
    <div id="blocker-modal" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <h3>Bloqueador de Sites</h3>
            <button id="close-blocker-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        
        <div class="blocker-controls">
            <div class="blocker-status">
                <span id="blocker-status-text">Inativo</span>
                <label class="switch">
                    <input type="checkbox" id="blocker-toggle">
                    <span class="slider round"></span>
                </label>
            </div>
        </div>

        <div class="add-site-section">
            <input type="text" id="blocked-site-input" placeholder="ex: facebook.com">
            <button id="add-blocked-site-btn" class="glass-panel-sm"><i class="ph ph-plus"></i></button>
        </div>

        <div id="blocked-sites-list" class="blocked-sites-list">
            <!-- Items injected by JS -->
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Manage Links Modal -->
    <div id="links-modal" class="glass-panel modal modal-center modal-scale" style="display: none;">
        <div class="modal-header">
            <h3>Gerenciar Links</h3>
            <button id="close-links-btn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        
        <div class="add-link-section">
            <input type="text" id="link-name-input" placeholder="Nome (max 20 chars)" maxlength="20">
            <input type="text" id="link-url-input" placeholder="URL (https://...)">
            <button id="add-link-btn" class="glass-panel-sm"><i class="ph ph-plus"></i></button>
        </div>

        <div id="manage-links-list" class="manage-links-list">
            <!-- Items injected here -->
        </div>
        <div class="links-note">
            <small>Máximo de 6 links.</small>
        </div>
    </div>

    <script src="scripts/utils.js"></script>
    <script src="scripts/modules/links.js"></script>
    <script src="scripts/modules/prayers.js"></script>
    <script src="scripts/modules/blocker.js"></script>
    <script src="scripts/modules/rosary.js"></script>
    <script src="scripts/modules/reminders.js"></script>
    <script src="scripts/modules/background.js"></script>
    <script src="scripts/modules/music.js"></script>
    <script src="scripts/modules/exam.js"></script>
    <script src="scripts/modules/focus.js"></script>
    <script src="scripts/main.js"></script>
</body>
</html>